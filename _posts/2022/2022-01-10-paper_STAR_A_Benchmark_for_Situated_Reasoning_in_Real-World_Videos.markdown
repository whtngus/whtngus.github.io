---
layout: post
title: "paper : STAR: A Benchmark for Situated Reasoning in Real-World Videos"
date: 2022-01-10 16:20:23 +0900
category: paper
---

# STAR: A Benchmark for Situated Reasoning in Real-World Videos

MIT-IBM Watson AI Lab

url : https://openreview.net/forum?id=EfgNF5-ZAjM

dataset link : http://star.csail.mit.edu/

# Abstract

주변 상황에서 현재의 지식을 포착하고 그에 따라 추론을 수행하는 방법은 기계 지능에 있어 매우 중요하고 어려운 일

실제 비디오에 대한 상황 추상화와 논리 기반 질문 답변을 통해 위치 추론 능력을 평가하는 새로운 벤치마크를 제한

인간의 행동 또는 상호 작용과 관련된 실제 비디오를 기반으로 하며, 이는 본질적으로 역동적이고 구성

데이터 세트에는 상호작용, 시퀀스, 예측 및 실현 가능성을 포함한 네 가지 유형의 질문이 포함

하이퍼그래프로 실제 비디오의 상황을 나타낸다.

시각적 인식 외에도 위치 추론은 구조화된 상황 이해와 논리적 추론을 필요로 한다.

과제를 이해하기 위해 시각적 인식, 상황 추상화, 언어 이해 및 기능적 추론을 분리할 수 있는 진단 신경 상징 모델을 제안

# 1 Introduction

![f_1](\img\2022\STAR_A_Benchmark_for_Situated_Reasoning_in_Real-World_Videos\f_1.PNG)

그림 1과 같은 특정 상황에서 우리는 어떤 상황에서 어떻게 빠르게 행동해야 하는지 알 수 있고 무의식적으로 실현 가능한 결정을 내릴 수 있다.

-> 구체적인 행동 이전에 논리적으로 생각 한다는것

상황을 이해하고 이에따라 현재의 상황을 추론하는 것을 상황 추론이라고 한다.

현재까지의 이미지 캡션등 이미지를 추론하는 것은 정해진 형식에서의 프레임워크를 제공한다.

즉 실제 시나리오에서 가능한 모든 논리 규칙을 만드는것은 불가능 하다.

![t_1](\img\2022\STAR_A_Benchmark_for_Situated_Reasoning_in_Real-World_Videos\t_1.PNG)

위 테이블에서 기존 QA 모델은 까다로운 작업에 어려움을 겪고 있다.

점점 더 복잡해지는 위치 추론을 탐구하기 위해 시스템이 동적 상황에서 현재 지식을 구조화된 표현으로 포착하고 그에 따라 질문에 답해야 하는 비디오를 통한 실제 위치 추론의 새로운 벤치마크인 STAR 1을 제안

일상 생활에서의 인간 활동이나 행동을 모범 도메인으로 삼고 실제 상황의 비디오 클립을 기반으로 데이터 세트를 구축

벤치마크에는 상호작용 질문, 시퀀스 질문, 예측 질문, 실현 가능성 질문의 4가지 유형이 포함

각각의 질문은 다양한 장면과 장소에서 온 행동 중심의 상황과 연관되며 여러 행동을 수반함

상황의 역동적인 변화를 표현하기 위해, 우리는 그것들을 실체와 관계와의 구조화된 표현인 상황 하이퍼그래프로 추상화

시각적 추론 능력을 위한 진단에 초점을 맞추고 있기 때문에 생성을 위해 간결한 형식과 질문 템플릿을 채택하여 언어 이해를 단순화

우리는 또한 인간이 쓴 더 어려운 질문으로 평가를 돕기 위해 STAR-Humans 보조 세트를 제공

답변 논리는 생성된 상황 하이퍼그래프를 통해 실행 프로그램에 기반을 둔 논리적 추론 과정을 설명

위의 표1에서와 같이 STAR는 다양한 측면에 대한 기존의 시각적 추론 벤치마크를 보완

실제 위치 추론을 위한 신경 상징 아키텍처인 NS-SR(Neuro-Symbolic Positioned Reference)이라는 진단 모델을 설계

- contribution

>> 1. 상호작용, 시퀀스, 예측 및 실현 가능성 질문에 초점을 맞춰 실제 비디오에서 위치 추론을 하는 문제를 체계적으로 공식화
>>
>> 2. 시각적 인식, 상황 추상화 및 논리 추론의 세 가지 관점에서 주석을 설계하는 위치 추론을 위해 잘 제어된 벤치마크 STAR를 구성
>>
>> 3. STAR에 대한 다양한 최첨단 방법을 평가하고 인간에게 사소한 상황에서도 여전히 많은 실수를 한다는 것을 발견
>>
>> 4. STAR 벤치마크의 과제에 대한 심층 분석을 위한 진단 신경 상징 프레임워크를 설계하고 보다 강력한 추론 모델을 구축하는 향후 방향을 제시

# 2. Related Work

- Visual Question Answering

시각 정보를 이해하고 질문에 답하는 테스크

설계된 질문을 제공하도록 요청, 미리 정의된 템플릿으로 질문을 합성함

시작적인 장면에서 사물, 행동, 관계를 이해하는데 초점을 맞추고 있음.

-> STAR는 실제 상황에서 동적 추론을 수행하고 명확한 단계별 추론을 제공하는 모델이 필요

- Visual Reasoning

문 답변 외에도, 모델의 추론 능력을 진단하기 위해 일부 데이터 세트가 도입

구성 속성과 논리 프로그램이 포함된 질문이 포함되며, 다단계 추론을 수행하려면 모델이 필요

합성 비디오의 물체에 초점을 맞춘다.

이러한 합성 장면이 실제 상황에서 논리적 복잡성을 반영할 수 있을 만큼 충분히 대표적인지는 의문으로 남아 있다.

- Situation Formalism

행동과 변화에 대한 추론을 위한 형식을 확립

상황 미적분학은 변화하는 시나리오를 1차 논리 공식의 집합으로 나타낸다

형식을 실제 상황에 직접 적용하는 것은 현실적이지 않다. 

제 상황은 역동적이고 잘 정의되지 않았고, 아직은 실제상황을 추론하는것은 도전중이다.

# 3. Situated Reasoning Benchmark

STAR는 인간과 같은 능력, 즉 위치추론을 평가

스템이 실제 상황에서 어려운 질문에 대한 추론을 배우고 수행

실제 데이터를 통해 위치 추론 벤치마크를 구축하는 것은 엄격한 제어 상황 단서와 잘 설계된 질문-응답 쌍이 필요하기 때문에 어렵다. 

상황 추상화와 논리적 추론을 결합하고 벤치마크 구성에서 세 가지 지침을 채택

- 상황은 추상화를 위한 상향식 주석에 기반한 계층적 그래프로 표현

- 위치 추론을 위한 질문 및 옵션 생성은 형식화된 질문, 기능 프로그램 및 공유 상황에 기초

- 위치 추론은 상황 그래프에 대해 반복적으로 수행할 수 있다

STAR는 프로그램과 정답이 있는 약 6만 개의 위치추론 질문과 24만 개의 후보 선택, 22만 개의 정리된 상황 동영상으로 구성

벤치마크의 상황 비디오는 일상 장면에서 인간 행동과 주변 환경의 동적 상호 작용 과정을 기록하는 인간 활동 비디오에서 가져온 것이다. 우리는 또한 구조화된 상황 추상화로 약 14만 4천 개의 상황 하이퍼그래프를 제공

설계된 질문은 위치 추론을 위한 네 가지 유형의 기술을 포함한다. 답변과 옵션이 포함된 주석이 달린 질문을 구성

질문 답변을 위한 상황 추상화와 추론 진단을 연결하기 위해 실행 프로그램과 연계된 상황 하이퍼그래프를 제공

STAR에는 111개의 액션 술어, 28개의 개체 및 24개의 관계가 포함됩니다. 벤치마크는 약 6:1:1의 비율로 교육/검증/테스트 세트로 분할

 ### 3.1 Situation Abstraction

- Situations

개체, 이벤트, 순간 및 환경을 설명

9K source videos with action annotations sampled from Charades dataset의 데이터를 이용해 구축 

이 영상들은 부엌, 거실, 침실 등 11개의 실내 장면에서 일상생활의 행동이나 활동을 묘사하고 있다. 

상황은 연속되거나 겹치는 동작과 상호작용이 여러 개 있는 잘린 비디오

상황에 맞는 깨끗하고 모호하지 않은 데이터 공간을 구성하기 위해 소스 비디오를 품질, 안정성 및 비디오 길이로 필터링

여러 동작의 시간적 경계 및 질문 논리에 따라 소스 비디오에서 잘라 상황적 정의에 따라 각 동작을 두 가지 동작으로 나눔

-> 즉 작용 전제 조건과 효과로 나눔 

동작 전제조건은 환경의 초기 정적 장면을 보여주는 시작 프레임, 액션 효과는 단일 액션 또는 여러 액션의 프로세스를 설명

상호작용 또는 시퀀스 질문의 상황은 완전한 행동 세그먼트를 포함

예측 질문(또는 실현 가능성 질문)의 상황은 질문에 관련된 조치와 답변에 대한 불완전한 행동 효과 세그먼트(또는 다른 행동 세그먼트 없음)를 포함한다.

- Situation Hypergraph

상황 비디오에서 추상적 표현을 추출하기 위해 STAR 벤치마크는 실제 상황에서 동적 프로세스를 하이퍼그래프의 형태로 설명하는 통합 스키마를 정의

상황 하이퍼그래프는 행동과 내적 관계, 그리고 상황 내의 계층 구조를 나타낸다.

림 1에서 볼 수 있듯이, 각 상황 비디오는 사람과 객체 노드가 있는 하위 그래프 세트

장자리는 프레임 내 관계(사람-객체 또는 객체-객체), 각 작업 하이퍼에지는 여러 하위 그래프를 연결

경우에 따라 여러 동작이 중복되고 하위 그래프의 노드가 공유

상황 하이퍼그래프 H는 H = (X, E) 쌍이며, 여기서 X는 상황 프레임에 나타난 물체나 사람에 대한 노드 집합이고, E는 행동에 대한 비어 있지 않은 하이퍼에지 하위그래프 Si의 집합이다.

하이퍼그래프 구조는 프레임 수준 하위 그래프 대신 하이퍼에지로 동작을 설명

치 주석은 Charades, personobject rel1에서 왔고, 객체/인물 주석은 ActionGenome에서 왔다

검출기 VCTree를 사용하여 객체-객체 관계(Rel2)를 추출하고, Rel1과 Rel2를 통해 관계 전파를 통해 더 많은 사람-객체 관계(Rel3)를 확장

>> <사람, 온, 의자>와 <의자, 테이블 왼쪽>이 존재한다면, <사람, 테이블 왼쪽>은 존재한다. 
>> 
>> 실험의 모든 모델은 비디오를 입력으로 사용하지만, 하이퍼그래프 주석(항목, 관계, 동작 또는 전체 그래프)을 사용하여 더 나은 시각적 인식 또는 구조화된 추상화를 배울 수 있다.

### 3.2 Questions and Answers Designing

- Question Generation

질문 생성은 특정 상황에서 다양한 답변을 시스템에 제공한다.

서로 다른 목적을 나타내고 위치 추론의 다양한 난이도를 다르는 여러 유형의 질문을 설꼐

> -  Interaction Question 
>
> 어떤 상황에서 인간과 물체 사이의 상호 작용을 이해하기 위한 기본적인 테스트
>
> - Sequence Question
>
> 동적 상황에서 연속적인 행동에 직면할 때 시스템의 관계 추론
>
> - Prediction Question 
>
> 현 상황에서 그럴듯한 행동에 대해. 보이는 상황에는 시작(1/4)만 포함됩니다.
>
> 질문은 미래의 행동이나 결과를 묻는다.
>
> - Feasibility Question
>
> 특정 상황에서 실현 가능한 행동을 추론할 수 있는 능력을 조사
>
> 상황을 제어하기 위해 공간 및 시간적 프롬프트(예: 공간 관계 및 시간적 관계)를 사용한다.

질문 유형의 논리적 일관성을 유지하기 위해 모든 유형의 질문은 잘 설계된 템플릿과 상황 하이퍼그래프의 데이터에서 파생

우리는 형식화된 질문 템플릿을 공유 데이터 유형 자리 표시자로 설계

하이퍼그래프(예: 사람, 객체, 동작 동사 또는 관계 등에 대한 [P], [O], [V], [R])에서 데이터 유형을 정렬

(1) 상황 주석과 하이퍼그래프에서 데이터 추출

(2) 추출된 데이터로 채워지는 질뭇 템플릿

(3) 구문 연어 및 형태학을 위한 언어 확장

- Debiasing and Balancing Strategies

![f_2](\img\2022\f_2.PNG)



질문과 답변에 나타난 동사/명사의 구성성을 제어하고 데이터셋 세계에서 다중 구성을 가진 동사나 명사만을 선택

그림 2 오른쪽 상단과 하단에는 답변의 편차를 줄이고 바로 가기를 해제하기 전과 후의 결과

STAR 데이터 세트가 계층화 단계 이후 더 균형 잡힌 분포를 갖는 추세

왼쪽 아래 그림 2에서 볼 수 있듯이, 우리는 각 옵션이 공정하게 정확할 수 있도록 옵션의 기업과 조치의 빈도를 조절

# 4 Baseline Evaluation

![t_2](\img\2022\t_2.PNG)

다양한 기준 모델을 테스트하고 위치 추론의 장단점을 분석

평가에서 모델은 주어진 문제에 대해 제공된 네 가지 후보 옵션 중에서 정답을 선택

모델 성능을 측정하기 위해 전체 질문의 평균 답변 정확도를 채택

 표 2에서는 네 가지 질문 유형에 따라 각 모델의 성능을 개별적으로 제시

각 질문에 대해, 우리는 실측 자료와 예측 결과 사이의 모든 옵션 정확성을 비교하여 질문당 답변 정확도를 계산

- Q-type (Random) : 임의로 답을 선택
- Q-type (Frequent) : 교육 세트에서 빈도가 가장 높은 답을 선택
- Blind Model (LSTM or BERT) :  질문과 선택을 인코딩하고 MLP를 사용하여 답을 예측
- CNN+LSTM : 언어와 시각적 맥락을 포착하기 위해 LSTM의 최종 상태
- CNN+BERT : 비디오 QA를 위해 VL-BERT 모델을 재구성
- L-GCN  : 반복적으로 위치 인식 GCN을 사용하여 객체의 공간-시간 관계를 모델링
- HCRN  : 계층적 조건부인 최신 비디오 질문 응답 모델
- ClipBERT  :  희박한 샘플링을 사용하여 비디오 질문 답변을 포함한 비디오 및 언어 작업에 대한 종단 간 학습을 가능하게 하는 최신 프레임워크

### 4.1 Comparison Analysis

표 2에 따르면 STAR는 다양한 유형의 모델이 다양한 성능을 가지고 있고 전체 평균 수준이 여전히 충분하지 않기 때문에 어려운 작업이라고 결론을 내릴 수 있다.

# 5 Diagnostic Model Evaluation

### 5.1 Model Design

- Video Parser

인간 중심/객체 중심 상호 작용을 얻는 일련의 검출기로 구성된 시각적 인식 모듈

비디오 파서는 시각적 특징 또는 경계 상자 영역을 얻기 위해 훈련 세트에서 상황 비디오 키 프레임에 대해 훈련된다. 

정량적 평가 결과는 보충 자료 표 2에 있다.

- Transformers-based Action Transition Mode

![f_3](\img\2022\f_3.PNG)



동적 현실 상황으로부터 구조화된 단서를 추출하기 위해, 우리는 하이퍼그래프 형태로 현재와 미래의 상황을 처리하고 예측하는 전환 모델을 제안

 상황 하이퍼그래프 인코더: NS-SR은 상황 하이퍼그래프를 통해 동적 상태 전환을 수행

인코더는 감지된 엔티티나 관계를 연결함으로써 "초기" 상황 하이퍼그래프를 구성하고 구조화된 하이퍼그래프 토큰 시퀀스에 그래프를 인코딩

### 5.2 Result Analysis

![image-20220112221248260](C:\Users\Suhyun\AppData\Roaming\Typora\typora-user-images\image-20220112221248260.png)

NS-SR의 모듈화로 인해 표 3(보충 재료 표 4)과 같이 완벽/불완전한 스위칭 설정 하에서 결과 제어 평가를 통해 STAR의 핵심 과제를 탐색할 수 있다

완벽한 상황 하이퍼그래프와 프로그램을 바탕으로 모든 질문에 답할 수 있기 때문에 놀라운 일이 아니다. 그런 다음 비교를 위해 NS-SR의 각 분리된 모듈을 교체하여 개별적이고 완벽한 조건을 제거한다. 마지막 행은 실제 정보를 사용하지 않는 버전의 성능

- Situation Abstraction

시뮬레이션을 위해 비디오 파서(불완전한 하이퍼그래프 형태)와 프로그램 파서의 실측 정보를 채택

시각적 인식과 추론 논리를 가지고 있지만, 완벽한 구조화된 상황 추상화가 없는 모델은 약 55.95% 감소했다. 

STAR에서 이상적인 위치 추론의 병목 현상이 상황 구조 추상화에 도전

- Visual Perception

위치 추론은 잘 수행된 시각적 지각을 필요로 한다.

성능이 많이 떨어져 어려움을 의미

- Language Understanding

완벽한 프로그램을 사용하지 않는 성능은 약간 감소(1% 이내)하여 STAR의 언어 인식이 어렵지 않음을 의미

언어 복잡성을 단순화하고 시각적으로 관련된 추론 과제에 더 많은 주의를 기울이기 때문에 타

- Without Ground-Truths

NS-SR의 전체 아키텍처를 사용

비디오 파서는 시각적 인식을 위해 감지 및 추출 결과를 제공

프로그램 파서는 주어진 질문과 옵션에서 구문 분석된 프로그램을 제공합니다. 지금은 결과가 좋지 않아 추가 탐사에 필요한 여백이 충분히 남아 있다. 우리는 미래의 방향이 실제 비디오에 대한 시각적 인식과 상황 추상화를 개선하는 데 초점을 맞추어야 한다고 제안



# 6 Conclusions

실제 상황에서 추론하는 방법을 탐구하기 위한 새로운 벤치마크 STAR를 소개

특정 상황에서 네 가지 유형의 질문(상호작용, 시퀀스, 예측 및 실현 가능성)에 대한 동적 상황과 합리적인 답변으로부터 학습해야 하는 상황 추론 작업을 설계

